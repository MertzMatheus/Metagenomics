# Metagenomics
This repository contains a complete shotgun metagenomics analysis pipeline, covering all steps from raw read processing to genome reconstruction (MAGs), taxonomic classification, and functional annotation. The pipeline is designed to be modular, reproducible, and easy to run, with dedicated Conda environments for each stage.


Pipeline Overview
1. Quality Control and Removal of Contaminants

Raw paired-end reads are processed to ensure data quality:

Tools Used

FastP — adapter trimming, quality filtering, and basic QC

Bowtie2 — removal of host reads

Kraken2 — identification and filtering of contaminant reads (e.g., human)

Steps performed:

Trim adapters and filter low-quality reads using FastP.

Map reads against the human genome using Bowtie2 to remove host contamination.

Run Kraken2 to classify reads and discard remaining contaminants.

2. Metagenomic Assembly

Assembly is performed using the MetaWRAP assembly module, which internally uses metaSPAdes.

Tools Used

MetaWRAP – assembly module (metaSPAdes)

Output:

High-quality contigs from the metagenomic dataset

3. Genome Binning

Multiple binning tools are used to maximize bin recovery and diversity:

Tools Used

MaxBin2

MetaBAT2

CONCOCT

These tools are run through the MetaWRAP binning module, which integrates coverage depth, composition, and co-abundance patterns.

4. Bin Refinement and Reassembly

Bins generated by the three tools are combined and refined using MetaWRAP.

Steps:

Bin refinement:

Keep bins with:

≥ 70% completeness

≤ 10% contamination

Reassembly:

The reassemble_bins module is used to improve MAG contiguity and quality, using only reads that map to each bin.

The final output consists of high-quality, non-redundant MAGs.

5. Quality Assessment

MAGs are evaluated to confirm genome completeness and contamination levels.

Tools Used

CheckM — completeness, contamination, and tree placement

BUSCO — protein-level completeness using lineage-specific markers

These provide quantitative validation of MAG quality.

6. Taxonomic Classification

Two methods are applied:

Tools Used

Kraken2 — fast, contig-based taxonomic profiling

GTDB-Tk — high-resolution taxonomy and phylogeny using the Genome Taxonomy Database

GTDB-Tk also produces:

Phylogenetic placement

Standardized taxonomy

Phylogenomic tree

7. Functional Annotation
7.1 Antibiotic Resistance

RGI (CARD) — identifies antibiotic resistance genes

StarAMR — detects AMR genes, MLST types, and resistance markers

7.2 Secondary Metabolites

antiSMASH — annotates biosynthetic gene clusters (BGCs)

Includes: NRPS, PKS, terpenes, RiPPs, siderophores, etc.

7.3 General Functional Insights

BUSCO and CheckM protein profiles

KEGG / COG assignments possible from GTDB-tk or additional pipelines (optional)
